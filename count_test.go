package mysqlgtid

import (
	"testing"
)

// TestSamples tests sample GTID values.
func TestSamples(t *testing.T) {
	var samples = map[string]int64{
		``:                                       0,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1`: 1,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1,2,3`:         3,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1-100`:         100,
		`011a7699-9e72-11ea-9234-246e96b3f01c:201-300`:       100,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1-100,201-300`: 200,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1-271229896`:   271229896,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1-271229896,
019a9028-fb64-11e9-8a8a-20677c089600:1-276903885`: 548133781,
		`011a7699-9e72-11ea-9234-aaaaaaaaaaaa:1-100,
019a9028-fb64-11e9-8a8a-bbbbbbbbbbbb:1-1000,
019a9028-fb64-11e9-8a8a-cccccccccccc:1-10000`: 11100,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1-271229896,
019a9028-fb64-11e9-8a8a-20677c089600:1-276903885,
09025802-ffe8-11ef-886e-fa163e0800eb:1-4,
0a0bd206-4750-11ee-9a88-246e96822b80:1-100492614,
0b52904d-357c-11ef-b8b7-e4434b38a310:1-281227647,
0da5a3de-6d18-11ee-8f9b-246e96945cf4:1-48952401,
0debc35a-f769-11ea-b675-d06726c8b520:1-243527571,
17caf23a-1367-11ef-a53f-246e96133074:1-388476302,
1a92366f-4f40-11eb-a0f1-246e96b583f0:1-1289485294,
1c38bce0-d95d-11ed-9938-246e96b0a560:1-179263152,
1e576058-a65c-11ef-a60f-58a2e1805562:1-1288117997,
1e9c2f47-a65c-11ef-ad9b-58a2e1804076:1-431083579,
1efd8947-0986-11ef-99a0-8030e0233b90:1-89131056,
1fe95c4c-0ba6-11ee-90eb-246e963345bc:1-324061176,
232d5f73-0842-11f0-b407-fa163e96f1ef:1-4,
261fd3a6-10ef-11ef-a4a3-9cdc71cd9a50:1-49433897,
294ea183-0bc9-11ef-9bbb-5820b1e37f50:1-28881207,
2bc4b0d9-a266-11ed-8f28-8cdcd41c54a0:1-304874340,
2c220b25-64ba-11ee-8ec0-8cdcd41d11f0:1-169193271,
2e95e677-45f0-11ea-b948-246e96b586e8:1-645261995,
3039cb26-bde9-11ed-8d03-d06726ab5fa0:1-2086681539,
339838bf-8a0c-11ee-a563-d06726ab68d0:1-148105400,
353be199-411d-11eb-8e3f-246e96b0a464:1-234045265,
387c0a50-988a-11ed-8295-e4434b38997c:1-34281302,
388b20cc-a266-11ed-9eab-e4434b3eda14:1-701262374,
3a845e4d-3870-11ee-85fc-e4434b3ee36c:1-264001073,
3df37ffe-dcf7-11ef-9123-b83fd25e86d6:1-91897374,
3f726e69-8b2f-11ed-b7c9-e4434b41b008:1-53765277,
407eba60-92ab-11ed-ad2c-9cdc7161b540:1-202204262,
4125eb65-a699-11ef-a35c-b83fd25e9f06:1-229515407,
4435bc0d-ab96-11ed-bd58-ecf4bbf090d0:1-234220806,
445c0119-54be-11eb-b0f6-246e96ba6118:1-4,
46cd8d8c-2013-11ee-b84a-246e96133074:1-2351134609,
488b5be2-4f22-11e9-bddf-246e962b0f6c:1-783629592,
4cf52bfc-27fa-11eb-9348-e4434b56a510:1-398600118,
4f3b425c-a0ce-11ed-9c8c-e4434b26c9d0:1-16665459,
561c8c49-0e2d-11ed-9f5a-e4434b21dc6c:1-238501607,
5dc4d140-fc9a-11ec-85d6-20677c098c00:1-510570440,
5ecee2cf-991a-11ed-8ecb-246e96825a50:1-25191101,
6201b226-8d9b-11ec-b2b4-246e96825c64:1-241362938,
64fc5c28-85d5-11ef-bb82-88e9a4593fc4:1-308265311,
669d63b6-b5dd-11ec-af15-e4434b335d30:1-96119683,
67cb51ae-b406-11ef-9046-58a2e1803f32:1-389821513,
6945a7cd-0847-11f0-8533-fa163e962696:1-2,
69a72494-5277-11ec-90a6-d06726aaa090:1-343250671,
6d049ddb-b6d0-11ed-a98e-246e962acee0:1-2286138017,
6ecab72a-37ee-11ec-a5f5-246e96945160:1-286227480,
6f44515d-1e53-11ed-894c-246e96c39eb0:1-381912191,
70f5c5eb-15f3-11ea-9b95-20677c08a150:1-42089575,
7574ca5a-6e9c-11ed-b0b2-e4434b26ca40:1-664677856,
75bbcca4-2c43-11e8-bdaa-d06726ab4950:1-93490972,
767d422b-c517-11ee-8bf3-246e969b7954:1-1706,
76f1d2f0-ab43-11eb-8210-246e96b0a9c0:1,
7a54faaa-d0f3-11ee-8f45-f40343a7d820:1-106599409,
7c84de5f-c21f-11ee-8b7c-246e96346814:1-13494779,
7dbe3d0d-d2a7-11ef-9726-b83fd2ba140a:1-476906633,
84d1b5ca-1d32-11eb-9ac4-246e96b0a600:1-599416425,
8f5dcdbe-6d5c-11ec-b023-e4434b26c2ec:1-203956084,
95920221-cdb4-11ec-8342-9cdc71d00700:1-311810378,
95aff48a-75fe-11ea-a080-20677c1ecca0:1-753174061,
96066c9f-a613-11ea-82f3-246e96b58ac4:1-129970156,
963371aa-32bc-11ec-9d95-f40343b28870:1-266824235,
9655cd17-ffb2-11e8-9f81-9cdc71cce7e0:1-1674042737,
9b47d5c9-96b9-11ef-8745-fa163ed6ef09:1-1380,
9ce1c22a-fe78-11ed-a073-246e967241fc:1-691438192,
9fb493ee-5604-11e9-9190-9cdc71cff550:1-1412097918,
a1baaac2-f861-11ec-abac-246e969b7bd8:1-1162383051,
a995f27e-4026-11eb-a309-246e96b0a49c:1-530424173,
aa39e946-48b0-11eb-b533-e4434b5812f4:1-270631117,
aa3c6756-1936-11eb-9cfa-246e96b58894:1-357667984,
ac98bb5a-a357-11ed-bb7e-e4434b3ee2a4:1-143717327,
ad1278d5-b065-11ea-b966-246e96b3f28c:1-66009460,
b06d72d0-cb70-11eb-9386-d06726c8b760:1-1205760198,
b117bb4d-7935-11ec-b4b2-d06726aab040:1-61102954,
b259a8d9-e8ad-11ef-865e-b83fd26c9538:1-454061294,
b3823ab2-54be-11eb-b252-20677c08a750:1-4,
b49fa797-2c84-11e8-9443-d06726abeaa0:1-616427564,
b578dd21-830d-11ee-852a-d06726ac7a30:1-151089930,
b7cc04a6-c01a-11ee-9f14-d06726ab68d0:1-12550309,
bae281af-a61c-11ea-9d3f-d06726c9ab50:1-200108620,
bcbaf881-933b-11ed-8a9c-246e968c73b4:1-1131040311,
c2312182-c76f-11ea-b434-246e96b58928:1-387799350,
cb4bafa7-a040-11ef-acd9-a088c25624f0:1-515740,
cbe58b85-9c2c-11eb-b8d0-8030e005aea0:1-313180147,
cd3a9fc5-a1d9-11ed-8c7e-246e96a37ee4:1-768715,
ce9fd100-8959-11ef-80e5-88e9a450cf14:1-109429997,
cfcb9562-96b3-11ef-9046-fa163eb45f43:1-1816,
d00c79a2-c6eb-11eb-8218-d06726c8be10:1-506470770,
d082c193-38ec-11ec-947a-246e96822bf4:1-1186442590,
d5123a47-a5fd-11ea-a910-246e96b58d80:1-137259188,
d71d9fcf-0df7-11ed-a850-e4434b389d98:1-361621394,
dcdb8465-db99-11ee-bfc3-f40343a7d820:1-5593771,
dd035ab2-95ae-11e8-974c-246e96825c18:1-323780845,
dd22caa7-5b43-11ea-91ff-246e96c113cc:1-1069194162,
e0177bd8-2c3f-11e8-9309-d06726aaa250:1-260572183,
e146cc98-82c2-11ec-a7c1-246e969b7bd4:1-2511735153,
e48f68b3-fdad-11ed-b57c-246e969ea928:1-666644725,
e4cfb85c-34e0-11f0-a093-b83fd25e6d2c:1-200522808,
e4e7dcfc-21c5-11ea-a432-246e96b0a50c:1-865680104,
e67819e9-cd86-11ec-a9bc-5820b1ed7b30:1-456695194,
e7a87407-9fa3-11ec-ba1f-e4434b26bfa4:1-110622394,
ea23d34b-3dba-11eb-a9ef-246e96bdca30:1-460387858,
ea574e00-e9c9-11ed-ac71-e4434b335ca8:1-2313,
ea7ae48a-4a40-11e8-a59f-246e9651aaa8:1-626709806,
ed09ffe2-e8d6-11ed-9c92-e4434b21d47c:1-1702,
efea5119-f485-11ec-9f12-f40343b986f0:1-1660311702,
f3b84a7a-d533-11e9-bedc-246e96c39b38:1-1541402064,
f4b3d3a2-e9dc-11ed-ad22-d06726acb770:1-331513088,
f6db6937-8ab1-11e8-890d-f40343a54920:1-4378816919,
f789ec1c-9f44-11ed-aa81-8030e00b59c0:1-627145,
f79c833d-f590-11ef-a9e1-fa163e98d48c:1-4,
fadbd852-6d28-11ec-9307-f40343a831c0:1-523169667,
fc0e178d-fa78-11ef-b97c-fa163e8f3276:1-2,
fd1c7ef1-e071-11ea-a547-d06726c9abe0:1-943066288,
fe3a5919-03ea-11ef-b5fa-d06726c9db60:1-1348369383,
ff40b05a-6cbb-11ed-a760-e4434b26c9c8:1-893681160`: 55332525043,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1-1000,
011a7699-9e72-11ea-9234-246e96b3f01c:tag1:1-1000`: 2000,
		`011a7699-9e72-11ea-9234-246e96b3f01c:1-1000,
011a7699-9e72-11ea-9234-246e96b3f01c::1-2000`: 3000,
	}

	if len(samples) == 0 {
		t.Errorf("BUG: no samples")
	}

	for gtidSet, expected := range samples {
		actual, err := TransactionCount(gtidSet)
		if err != nil {
			t.Errorf("- FAIL: TransactionCount(%q) returned an error: %s, expected: %d", gtidSet, err, expected)
		} else if expected != actual {
			t.Errorf("- FAIL: TransactionCount(%q) returned: %d, expected: %d", gtidSet, actual, expected)
		}
	}
}
